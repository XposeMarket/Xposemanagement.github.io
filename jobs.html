<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jobs</title><link rel="stylesheet" href="styles.css"></head><body>
<header class="top">
  <div class="container row top row">
    <a class="brand" href="dashboard.html" aria-label="Home">
      <img id="headerLogo" src="XposeManagementCRMlogo.png" alt="Logo">
    </a>
    <button id="menuToggle" class="menu-toggle" aria-label="Toggle menu"><span></span><span></span><span></span></button><nav id="mainNav">
      <a href="dashboard.html" class="">Dashboard</a>
      <a href="appointments.html" class="">Appointments</a>
      <a href="jobs.html" class="active">Jobs</a>
      <a href="messages.html" class="">Messages</a>
      <a href="invoices.html" class="">Invoices</a>
      <a href="customers.html" class="">Customers</a>
      <a href="settings.html" class="">Settings</a>
      <a href="profile.html" class="">Profile</a>
    </nav>
    <div>
      <button id="themeToggle" class="btn" aria-label="Toggle theme">Theme</button>
      <button id="logoutBtn" class="btn" aria-label="Logout">Logout</button>
    </div>
  </div>
</header>
<div id="notification" class="notification hidden"></div>
<main class="container" style="padding:16px 0"><h1>Jobs</h1>

<!-- Existing card (kept 1:1, just a heading added) -->
<div class="card">
  <h3>Active Jobs (In progress)</h3>
  <table class="table" id="jobsTable">
    <thead><tr>
      <th class="sortable" data-col="id">Job #</th>
      <th class="sortable" data-col="customer">Customer</th>
      <th class="sortable" data-col="vehicle">Vehicle</th>
      <th class="sortable" data-col="service">Service</th>
      <th class="sortable" data-col="status">Status</th>
      <th class="sortable" data-col="assigned">Assigned To</th>
      <th>Actions</th>
    </tr></thead>
    <tbody></tbody>
  </table>
  <p class="notice" id="jobsEmpty"></p>
</div>

<!-- New, second card (staff-only population handled by app.js) -->
<div class="card" id="awaitWrap" style="margin-top:16px">
  <h3>Awaiting Parts</h3>
  <table class="table" id="awaitTable">
    <thead><tr>
      <th class="sortable" data-col="id">Job #</th>
      <th class="sortable" data-col="customer">Customer</th>
      <th class="sortable" data-col="vehicle">Vehicle</th>
      <th class="sortable" data-col="service">Service</th>
      <th class="sortable" data-col="status">Status</th>
      <th class="sortable" data-col="assigned">Assigned To</th>
      <th>Actions</th>
    </tr></thead>
    <tbody></tbody>
  </table>
  <p class="notice" id="awaitEmpty"></p>
</div>



<!-- Add Parts Modal -->
<div id="addPartsModal" class="card hidden" style="position:fixed; right:20px; bottom:20px; max-width:680px; z-index:65">
  <div class="toolbar" style="justify-content:space-between">
    <h3>Add Parts</h3>
    <button id="closeAddParts" class="btn">Close</button>
  </div>
  <div class="grid cols-2" style="margin-top:8px">
    <div>
      <label>Part Name</label>
      <input id="partName" placeholder="e.g., Brake Pads">
    </div>
    <div>
      <label>Quantity</label>
      <input id="partQty" type="number" value="1" min="1">
    </div>
    <div>
      <label>Price</label>
      <input id="partPrice" type="number" step="0.01" placeholder="0.00">
    </div>
  </div>
    <div class="toolbar" style="margin-top:8px; justify-content:flex-end">
    <button id="addToInvoiceBtn" class="btn info">Add to Invoice</button>
  </div>
  <p class="notice" id="addPartsNote"></p>
</div>

<!-- Labor Modal (shown right after selecting a part) -->
<div id="laborModal" class="card hidden" style="position:fixed; right:20px; bottom:20px; max-width:420px; z-index:70">
  <div class="toolbar" style="justify-content:space-between">
    <h3>Add Labor</h3>
    <button id="labClose" class="btn">Close</button>
  </div>

  <div class="grid cols-2" style="margin-top:8px">
    <div>
      <label>Labor Description</label>
      <input id="labDesc" placeholder="e.g., Brake Pad Replacement">
    </div>
    <div>
      <label>Hours</label>
      <input id="labHours" type="number" step="0.25" placeholder="1.5">
    </div>
    <div>
      <label>Rate per Hour</label>
      <input id="labRate" type="number" step="0.01" placeholder="85.00">
    </div>
  </div>
  <div class="toolbar" style="margin-top:8px; justify-content:flex-end">
    <button id="addLaborBtn" class="btn info">Add Labor</button>
    <button id="skipLaborBtn" class="btn">Skip Labor</button>
  </div>
  <p class="notice" id="labNote" class="notice"></p>
</div>

<!-- Parts Finder Modal (non-breaking; EDIT mode) -->
<div id="partsModal" class="card hidden" style="position:fixed; right:20px; bottom:20px; max-width:680px; z-index:60">
  <div class="toolbar" style="justify-content:space-between">
    <h3>Find Parts <span style="color:#666;font-weight:normal;font-size:0.85em">(Beta) Coming Soon</span></h3>
    <button id="closeParts" class="btn">Close</button>
  </div>
  <div style="padding: 20px; text-align: center;">
    <p style="margin-bottom: 20px; color: #666;">Automated parts search is coming soon!</p>
    <p style="margin-bottom: 20px;">In the meantime, you can manually add parts to invoices.</p>
  <button id="openAddPartsFromFinder" class="btn info">Add Parts Manually</button>
  </div>
  <div class="grid cols-2" style="margin-top:8px; display:none">
    <div>
      <label>Vehicle</label>
      <input id="pfVehicle" disabled>
    </div>
    <div>
      <label>Keyword</label>
      <input id="pfQuery" placeholder="e.g., brake pads">
    </div>
<!-- NEW: Optional VIN for precise fitment -->
<div style="margin-top:8px">
  <label>VIN (optional)</label>
  <input id="pfVin" maxlength="17" placeholder="17 characters">
</div>
  <div class="toolbar" style="margin-top:8px; justify-content:flex-end">
    <button id="pfSearch" class="btn">Search</button>
  </div>
  <div id="pfResults" style="margin-top:8px"></div>
  <p class="notice" id="pfNote"></p>
</div>
<!-- Labor Modal (shown right after selecting a part) -->
<div id="laborModal" class="card hidden" style="position:fixed; right:20px; bottom:20px; max-width:420px; z-index:70">
  <div class="toolbar" style="justify-content:space-between">
    <h3>Add Labor</h3>
    <button id="labClose" class="btn">Close</button>
  </div>

  <div class="grid cols-2" style="margin-top:8px">
    <div>
      <label>Hours</label>
      <input id="labHours" type="number" min="0" step="0.1" value="1">
    </div>
    <div>
      <label>Rate</label>
      <select id="labRateSel"></select>
    </div>
  </div>

  <div class="toolbar" style="margin-top:10px; justify-content:flex-end">
    <button id="labConfirm" class="btn info">Add</button>
  </div>

  </div>
</div>

</main>

<div id="statusModal" class="modal-overlay hidden" onclick="closeStatusModal()">
  <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 400px;">
    <div class="modal-head">
      <h3>Select Status</h3>
      <button onclick="closeStatusModal()" class="btn-close">&times;</button>
    </div>
    <div class="modal-body">
      <div id="statusPills" style="display: flex; flex-direction: column; gap: 12px;">
        <!-- Pills will be populated -->
      </div>
    </div>
  </div>
</div>

<div id="removeModal" class="modal-overlay hidden" onclick="closeRemoveModal()">
  <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 400px;">
    <div class="modal-head">
      <h3>Remove Job</h3>
      <button onclick="closeRemoveModal()" class="btn-close">&times;</button>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to remove this job?</p>
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 20px;">
        <button id="removeJobBtn" class="btn danger" style="width: 100%;">Remove Job</button>
        <button id="removeJobApptBtn" class="btn danger" style="width: 100%;">Remove Job & Appointment</button>
        <button id="cancelRemoveBtn" class="btn" style="width: 100%;">Cancel</button>
      </div>
    </div>
  </div>
</div>

<footer class="container">Â© Xpose Market</footer><script src="vendor/supabase.umd.js"></script><script type="module" src="app.js"></script><script src="multi-tenant.js"></script>
</body></html>

